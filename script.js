// ========== IMÁGENES DE GALERÍAS (DECLARAR PRIMERO) ==========
const galleryImages = {
    '1a': [
        './images/1/1a/20250926_084007.jpg',
        './images/1/1a/20250926_084012.jpg',
        './images/1/1a/20250926_084019.jpg',
        './images/1/1a/20250926_084027.jpg',
        './images/1/1a/20250926_084108.jpg',
        './images/1/1a/20250926_084558.jpg',
        './images/1/1a/20250926_084610.jpg',
        './images/1/1a/20250926_084639.jpg',
        './images/1/1a/20250926_084652.jpg',
        './images/1/1a/20251003_083829.jpg',
        './images/1/1a/20251003_083833.jpg',
        './images/1/1a/20251003_083838.jpg',
        './images/1/1a/20251003_083846.jpg',
        './images/1/1a/20251003_083849.jpg',
        './images/1/1a/20251003_083900.jpg',
        './images/1/1a/20251003_083906.jpg',
        './images/1/1a/20251003_083916.jpg',
        './images/1/1a/20251003_083924.jpg',
        './images/1/1a/20251003_084009.jpg',
        './images/1/1a/20251006_080507.jpg',
        './images/1/1a/20251006_080550.jpg',
        './images/1/1a/20251006_080557.jpg',
        './images/1/1a/20251006_080619.jpg',
        './images/1/1a/20251006_080635.jpg',
        './images/1/1a/20251006_080640.jpg',
        './images/1/1a/20251006_080649.jpg',
        './images/1/1a/20251006_080657.jpg',
        './images/1/1a/20251006_080719.jpg',
        './images/1/1a/20251006_080727.jpg',
        './images/1/1a/20251031_085037.jpg',
        './images/1/1a/20251031_085041.jpg',
        './images/1/1a/20251031_085052.jpg',
        './images/1/1a/20251031_085055.jpg',
        './images/1/1a/20251031_085109.jpg',
        './images/1/1a/20251031_085621.jpg',
        './images/1/1a/20251031_085629.jpg',
        './images/1/1a/20251031_085649.jpg',
        './images/1/1a/20251031_085705.jpg',
        './images/1/1a/20251031_085716.jpg',
        './images/1/1a/20251031_085918.jpg'
    ],
    '1b': [
        './images/1/1b/20250926_094454.jpg',
        './images/1/1b/20250926_094510.jpg',
        './images/1/1b/20250926_094516.jpg',
        './images/1/1b/20250926_094521.jpg',
        './images/1/1b/20250926_094544.jpg',
        './images/1/1b/20250926_094559.jpg',
        './images/1/1b/20250926_094606.jpg',
        './images/1/1b/20251003_085936.jpg',
        './images/1/1b/20251003_085943.jpg',
        './images/1/1b/20251003_090016.jpg',
        './images/1/1b/20251003_095346.jpg',
        './images/1/1b/20251003_095355.jpg',
        './images/1/1b/20251003_095409.jpg',
        './images/1/1b/20251003_095432.jpg',
        './images/1/1b/20251003_095459.jpg',
        './images/1/1b/20251003_095523.jpg',
        './images/1/1b/20251003_095534.jpg',
        './images/1/1b/20251003_095546.jpg',
        './images/1/1b/20251003_095625.jpg',
        './images/1/1b/20251003_095636.jpg',
        './images/1/1b/20251003_095659.jpg',
        './images/1/1b/20251003_095702.jpg',
        './images/1/1b/20251003_095711.jpg',
        './images/1/1b/20251031_094524.jpg',
        './images/1/1b/20251031_095411.jpg',
        './images/1/1b/20251031_095440.jpg',
        './images/1/1b/20251031_095447.jpg',
        './images/1/1b/20251031_095456.jpg',
        './images/1/1b/20251031_095510.jpg',
        './images/1/1b/20251031_095526.jpg',
        './images/1/1b/20251031_095529.jpg',
        './images/1/1b/20251031_095539.jpg',
        './images/1/1b/20251031_095607.jpg',
        './images/1/1b/20251031_095619.jpg'
    ],
    '1c': [
        './images/1/1c/20250926_104842.jpg',
        './images/1/1c/20250926_104850.jpg',
        './images/1/1c/20250926_104900.jpg',
        './images/1/1c/20250926_104904.jpg',
        './images/1/1c/20250926_104913.jpg',
        './images/1/1c/20250926_104923.jpg',
        './images/1/1c/20250926_104927.jpg',
        './images/1/1c/20250926_105001.jpg',
        './images/1/1c/20250926_105003.jpg',
        './images/1/1c/20251003_105218.jpg',
        './images/1/1c/20251003_105241.jpg',
        './images/1/1c/20251003_105311.jpg',
        './images/1/1c/20251003_105349.jpg',
        './images/1/1c/20251003_105406.jpg',
        './images/1/1c/20251003_105422.jpg',
        './images/1/1c/20251003_105435.jpg',
        './images/1/1c/20251003_105501.jpg',
        './images/1/1c/20251003_105511.jpg',
        './images/1/1c/20251003_105549.jpg',
        './images/1/1c/20251003_105603.jpg',
        './images/1/1c/20251003_105618.jpg',
        './images/1/1c/20251003_105627.jpg',
        './images/1/1c/20251003_105634.jpg',
        './images/1/1c/20251003_105644.jpg',
        './images/1/1c/20251003_105724.jpg',
        './images/1/1c/20251031_105359.jpg',
        './images/1/1c/20251031_105425.jpg',
        './images/1/1c/20251031_105430.jpg',
        './images/1/1c/20251031_105443.jpg',
        './images/1/1c/20251031_105449.jpg',
        './images/1/1c/20251031_105549.jpg',
        './images/1/1c/20251031_105604.jpg',
        './images/1/1c/20251031_105607.jpg',
        './images/1/1c/20251031_105730.jpg'
    ],
    '3a': [
        './images/3/3a/20250925_111656.jpg',
        './images/3/3a/20250925_111717.jpg',
        './images/3/3a/20250925_111723.jpg',
        './images/3/3a/20250925_111749.jpg',
        './images/3/3a/20250925_111755.jpg',
        './images/3/3a/20250925_111804.jpg',
        './images/3/3a/20250925_111808.jpg',
        './images/3/3a/20250925_111816.jpg',
        './images/3/3a/20250925_111827.jpg',
        './images/3/3a/20250925_111847.jpg',
        './images/3/3a/20250925_111855.jpg',
        './images/3/3a/20250925_111906.jpg',
        './images/3/3a/20250925_111925.jpg',
        './images/3/3a/20250925_111927.jpg',
        './images/3/3a/20250925_111948.jpg',
        './images/3/3a/20250925_112000.jpg',
        './images/3/3a/20250925_112007.jpg',
        './images/3/3a/20250925_112017.jpg',
        './images/3/3a/20250925_112027.jpg',
        './images/3/3a/20250925_112030.jpg',
        './images/3/3a/20250925_112034.jpg',
        './images/3/3a/20250925_112038.jpg',
        './images/3/3a/20250925_112428.jpg',
        './images/3/3a/20250925_112837.jpg',
        './images/3/3a/20250925_113208.jpg',
        './images/3/3a/20250925_113321.jpg',
        './images/3/3a/20250925_113546.jpg',
        './images/3/3a/20250925_114209.jpg',
        './images/3/3a/20250925_114428.jpg',
        './images/3/3a/20250925_114453.jpg',
        './images/3/3a/20251001_094224.jpg',
        './images/3/3a/20251001_094232.jpg',
        './images/3/3a/20251001_094235.jpg',
        './images/3/3a/20251001_094237.jpg',
        './images/3/3a/20251001_094240.jpg',
        './images/3/3a/20251001_094244.jpg',
        './images/3/3a/20251001_094246.jpg',
        './images/3/3a/20251001_094249.jpg',
        './images/3/3a/20251001_094253.jpg',
        './images/3/3a/20251001_094300.jpg',
        './images/3/3a/20251001_094305.jpg',
        './images/3/3a/20251001_094327.jpg',
        './images/3/3a/20251001_094333.jpg',
        './images/3/3a/20251001_094338.jpg',
        './images/3/3a/20251001_094341.jpg',
        './images/3/3a/20251001_094346.jpg',
        './images/3/3a/20251001_094349.jpg',
        './images/3/3a/20251001_094400.jpg'
    ],
    '3b': [
        './images/3/3b/20250925_102558.jpg',
        './images/3/3b/20250925_102622.jpg',
        './images/3/3b/20250925_102635.jpg',
        './images/3/3b/20250925_102641.jpg',
        './images/3/3b/20250925_102645.jpg',
        './images/3/3b/20250925_102648.jpg',
        './images/3/3b/20250925_102657.jpg',
        './images/3/3b/20250925_102700.jpg',
        './images/3/3b/20250925_102708.jpg',
        './images/3/3b/20250925_102715.jpg',
        './images/3/3b/20250925_102720.jpg',
        './images/3/3b/20250925_102732.jpg',
        './images/3/3b/20250925_102742.jpg',
        './images/3/3b/20250925_102745.jpg',
        './images/3/3b/20250925_102800.jpg',
        './images/3/3b/20250925_102817.jpg',
        './images/3/3b/20250925_102824.jpg',
        './images/3/3b/20250925_102829.jpg',
        './images/3/3b/20250925_102836.jpg',
        './images/3/3b/20250925_102842.jpg',
        './images/3/3b/20250925_102845.jpg',
        './images/3/3b/20250925_102854.jpg',
        './images/3/3b/20250925_102857.jpg',
        './images/3/3b/20250925_102902.jpg',
        './images/3/3b/20250925_103024.jpg',
        './images/3/3b/20250925_105523.jpg',
        './images/3/3b/20250925_105715.jpg',
        './images/3/3b/20250925_105743.jpg',
        './images/3/3b/20250925_105834.jpg',
        './images/3/3b/20251002_101902.jpg',
        './images/3/3b/20251002_101909.jpg',
        './images/3/3b/20251002_101911.jpg',
        './images/3/3b/20251002_101920.jpg',
        './images/3/3b/20251002_102020.jpg',
        './images/3/3b/20251002_102030.jpg',
        './images/3/3b/20251002_102035.jpg',
        './images/3/3b/20251002_102908.jpg',
        './images/3/3b/20251002_103510.jpg',
        './images/3/3b/20251002_103518.jpg',
        './images/3/3b/20251002_103527.jpg',
        './images/3/3b/20251002_103537.jpg',
        './images/3/3b/20251002_103542.jpg'
    ],
    '3c': [
        './images/3/3c/20251001_103433.jpg',
        './images/3/3c/20251001_103438.jpg',
        './images/3/3c/20251001_103441.jpg',
        './images/3/3c/20251001_103444.jpg',
        './images/3/3c/20251001_103449.jpg',
        './images/3/3c/20251001_103454.jpg',
        './images/3/3c/20251001_103500.jpg',
        './images/3/3c/20251001_103508.jpg',
        './images/3/3c/20251001_103518.jpg',
        './images/3/3c/20251001_103527.jpg',
        './images/3/3c/20251001_103534.jpg',
        './images/3/3c/20251001_103545.jpg',
        './images/3/3c/20251001_103548.jpg',
        './images/3/3c/20251001_103603.jpg',
        './images/3/3c/20251001_103610.jpg',
        './images/3/3c/20251001_103614.jpg',
        './images/3/3c/20251001_103617.jpg',
        './images/3/3c/20251001_103625.jpg',
        './images/3/3c/20251001_103629.jpg',
        './images/3/3c/20251001_103631.jpg',
        './images/3/3c/20251001_103637.jpg',
        './images/3/3c/20251001_103639.jpg',
        './images/3/3c/20251001_103642.jpg',
        './images/3/3c/20251008_103322.jpg',
        './images/3/3c/20251008_103329.jpg',
        './images/3/3c/20251008_103331.jpg',
        './images/3/3c/20251008_103335.jpg',
        './images/3/3c/20251008_103339.jpg',
        './images/3/3c/20251008_103342.jpg',
        './images/3/3c/20251008_103349.jpg',
        './images/3/3c/20251008_103352.jpg',
        './images/3/3c/20251008_103355.jpg',
        './images/3/3c/20251008_103400.jpg',
        './images/3/3c/20251008_103406.jpg',
        './images/3/3c/20251008_103407.jpg',
        './images/3/3c/20251008_103413.jpg',
        './images/3/3c/20251008_103420.jpg',
        './images/3/3c/20251008_103426.jpg',
        './images/3/3c/20251008_103429.jpg',
        './images/3/3c/20251008_103451.jpg',
        './images/3/3c/20251008_103455.jpg',
        './images/3/3c/20251008_103458.jpg',
        './images/3/3c/20251008_103501.jpg',
        './images/3/3c/20251008_103504.jpg',
        './images/3/3c/20251008_103508.jpg',
        './images/3/3c/20251008_103520.jpg',
        './images/3/3c/20251008_103537.jpg',
        './images/3/3c/20251008_103545.jpg',
        './images/3/3c/20251027_113634.jpg'
    ],
    '6a': [
        './images/6/6a/20251001_082521.jpg',
        './images/6/6a/20251001_082532.jpg',
        './images/6/6a/20251001_082536.jpg',
        './images/6/6a/20251001_082542.jpg',
        './images/6/6a/20251001_082550.jpg',
        './images/6/6a/20251001_082557.jpg',
        './images/6/6a/20251001_082602.jpg',
        './images/6/6a/20251001_082612.jpg',
        './images/6/6a/20251001_082624.jpg',
        './images/6/6a/20251001_082630.jpg',
        './images/6/6a/20251001_082636.jpg',
        './images/6/6a/20251001_082650.jpg',
        './images/6/6a/20251001_082655.jpg',
        './images/6/6a/20251001_082710.jpg',
        './images/6/6a/20251001_082717.jpg',
        './images/6/6a/20251001_082725.jpg',
        './images/6/6a/20251001_082729.jpg',
        './images/6/6a/20251001_082734.jpg',
        './images/6/6a/20251001_082739.jpg',
        './images/6/6a/20251001_082741.jpg',
        './images/6/6a/20251001_082745.jpg',
        './images/6/6a/20251001_082753.jpg',
        './images/6/6a/20251001_082821.jpg',
        './images/6/6a/20251001_082823.jpg',
        './images/6/6a/20251001_082826.jpg',
        './images/6/6a/20251001_083146.jpg',
        './images/6/6a/20251001_083925.jpg',
        './images/6/6a/20251001_083929.jpg',
        './images/6/6a/20251006_083233.jpg',
        './images/6/6a/20251006_083238.jpg',
        './images/6/6a/20251006_083241.jpg',
        './images/6/6a/20251006_083249.jpg',
        './images/6/6a/20251006_083255.jpg',
        './images/6/6a/20251006_083259.jpg',
        './images/6/6a/20251006_083303.jpg',
        './images/6/6a/20251006_083306.jpg',
        './images/6/6a/20251006_083316.jpg',
        './images/6/6a/20251006_083323.jpg',
        './images/6/6a/20251006_083332.jpg',
        './images/6/6a/20251006_083341.jpg',
        './images/6/6a/20251006_083346.jpg',
        './images/6/6a/20251006_083422.jpg',
        './images/6/6a/20251006_083431.jpg',
        './images/6/6a/20251006_083436.jpg',
        './images/6/6a/20251006_083438.jpg',
        './images/6/6a/20251006_083442.jpg',
        './images/6/6a/20251006_083540.jpg',
        './images/6/6a/20251008_082858.jpg',
        './images/6/6a/20251008_082902.jpg',
        './images/6/6a/20251008_082906.jpg',
        './images/6/6a/20251008_082915.jpg',
        './images/6/6a/20251008_082921.jpg',
        './images/6/6a/20251008_082945(0).jpg',
        './images/6/6a/20251008_082953.jpg',
        './images/6/6a/20251008_085017.jpg',
        './images/6/6a/20251008_085023.jpg',
        './images/6/6a/20251008_085025.jpg',
        './images/6/6a/20251013_081746.jpg',
        './images/6/6a/20251013_081749.jpg',
        './images/6/6a/20251013_081758.jpg',
        './images/6/6a/20251013_083232.jpg',
        './images/6/6a/20251013_083236.jpg',
        './images/6/6a/20251013_083244.jpg',
        './images/6/6a/20251013_083253.jpg',
        './images/6/6a/20251013_083316.jpg',
        './images/6/6a/20251013_083324.jpg',
        './images/6/6a/20251013_083328.jpg',
        './images/6/6a/20251013_083334.jpg',
        './images/6/6a/20251013_083337.jpg',
        './images/6/6a/20251013_083343.jpg',
        './images/6/6a/20251013_083357.jpg',
        './images/6/6a/20251013_083401.jpg',
        './images/6/6a/20251013_083409.jpg',
        './images/6/6a/20251013_083419.jpg',
        './images/6/6a/20251013_083512.jpg',
        './images/6/6a/20251022_083927.jpg',
        './images/6/6a/20251022_083941.jpg',
        './images/6/6a/20251022_083944.jpg',
        './images/6/6a/20251022_083951.jpg',
        './images/6/6a/20251022_083956.jpg',
        './images/6/6a/20251022_084002.jpg',
        './images/6/6a/20251022_084007.jpg',
        './images/6/6a/20251022_084019.jpg',
        './images/6/6a/20251022_084027.jpg',
        './images/6/6a/20251022_084038.jpg',
        './images/6/6a/20251022_084041.jpg',
        './images/6/6a/20251022_084046.jpg',
        './images/6/6a/20251022_084055.jpg'
    ],
    '6b': [
        './images/6/6b/20251013_092927(1).jpg',
        './images/6/6b/20251013_092927.jpg',
        './images/6/6b/20251013_092934(1).jpg',
        './images/6/6b/20251013_092934.jpg',
        './images/6/6b/20251013_092937(1).jpg',
        './images/6/6b/20251013_092937.jpg',
        './images/6/6b/20251013_092946(1).jpg',
        './images/6/6b/20251013_092946.jpg',
        './images/6/6b/20251013_092950(1).jpg',
        './images/6/6b/20251013_092950.jpg',
        './images/6/6b/20251013_093007(1).jpg',
        './images/6/6b/20251013_093007.jpg',
        './images/6/6b/20251013_093017.jpg',
        './images/6/6b/20251013_093035(1).jpg',
        './images/6/6b/20251013_093035.jpg',
        './images/6/6b/20251013_093037.jpg',
        './images/6/6b/20251013_093043(1).jpg',
        './images/6/6b/20251013_093043.jpg',
        './images/6/6b/20251013_093045(1).jpg',
        './images/6/6b/20251013_093045.jpg',
        './images/6/6b/20251013_093051(1).jpg',
        './images/6/6b/20251013_093051.jpg',
        './images/6/6b/20251013_093057.jpg',
        './images/6/6b/20251013_093100(1).jpg',
        './images/6/6b/20251013_093100.jpg',
        './images/6/6b/20251013_093109.jpg',
        './images/6/6b/20251013_093124(1).jpg',
        './images/6/6b/20251013_093124.jpg',
        './images/6/6b/20251013_093128.jpg',
        './images/6/6b/20251013_093137(1).jpg',
        './images/6/6b/20251013_093137.jpg',
        './images/6/6b/20251013_093145.jpg',
        './images/6/6b/20251020_090819(1).jpg',
        './images/6/6b/20251020_090819.jpg',
        './images/6/6b/20251020_091255(1).jpg',
        './images/6/6b/20251020_091255.jpg',
        './images/6/6b/20251020_093310.jpg',
        './images/6/6b/20251020_093541.jpg',
        './images/6/6b/20251023_090720(1).jpg',
        './images/6/6b/20251023_090720.jpg',
        './images/6/6b/20251023_090756(1).jpg',
        './images/6/6b/20251023_090756.jpg',
        './images/6/6b/20251023_091217.jpg',
        './images/6/6b/20251106_091731(1).jpg',
        './images/6/6b/20251106_091731.jpg',
        './images/6/6b/20251106_091740(1).jpg',
        './images/6/6b/20251106_091740.jpg',
        './images/6/6b/20251106_091801(1).jpg',
        './images/6/6b/20251106_091801.jpg',
        './images/6/6b/20251106_091903.jpg',
        './images/6/6b/20251106_091908(1).jpg',
        './images/6/6b/20251106_091908.jpg',
        './images/6/6b/20251106_092556.jpg',
        './images/6/6b/20251106_094109(1).jpg',
        './images/6/6b/20251106_094109.jpg',
        './images/6/6b/20251106_094119(1).jpg',
        './images/6/6b/20251106_094119.jpg',
        './images/6/6b/20251106_094121(1).jpg',
        './images/6/6b/20251106_094121.jpg',
        './images/6/6b/20251106_094625(1).jpg',
        './images/6/6b/20251106_094625.jpg'
    ],
    '6c': [
        './images/6/6c/20251002_082216.jpg',
        './images/6/6c/20251002_082223.jpg',
        './images/6/6c/20251002_082231.jpg',
        './images/6/6c/20251002_082236.jpg',
        './images/6/6c/20251002_082242.jpg',
        './images/6/6c/20251002_082247.jpg',
        './images/6/6c/20251002_082254.jpg',
        './images/6/6c/20251002_082259.jpg',
        './images/6/6c/20251002_082312.jpg',
        './images/6/6c/20251002_082327.jpg',
        './images/6/6c/20251002_082332.jpg',
        './images/6/6c/20251002_082335.jpg',
        './images/6/6c/20251002_082340.jpg',
        './images/6/6c/20251002_082345.jpg',
        './images/6/6c/20251002_082348.jpg',
        './images/6/6c/20251002_082356.jpg',
        './images/6/6c/20251002_082410.jpg',
        './images/6/6c/20251002_082414.jpg',
        './images/6/6c/20251002_082421.jpg',
        './images/6/6c/20251002_082426.jpg',
        './images/6/6c/20251002_082428.jpg',
        './images/6/6c/20251002_082443.jpg',
        './images/6/6c/20251013_103901.jpg',
        './images/6/6c/20251013_103906.jpg',
        './images/6/6c/20251013_103915.jpg',
        './images/6/6c/20251013_103937.jpg',
        './images/6/6c/20251013_103941.jpg',
        './images/6/6c/20251013_103945.jpg',
        './images/6/6c/20251013_103952.jpg',
        './images/6/6c/20251013_103957.jpg',
        './images/6/6c/20251013_104000.jpg',
        './images/6/6c/20251013_104002.jpg',
        './images/6/6c/20251013_104004.jpg',
        './images/6/6c/20251013_104010.jpg',
        './images/6/6c/20251013_104014.jpg',
        './images/6/6c/20251013_104028.jpg',
        './images/6/6c/20251013_104033.jpg',
        './images/6/6c/20251013_104035.jpg',
        './images/6/6c/20251013_104038.jpg',
        './images/6/6c/20251027_101006.jpg',
        './images/6/6c/20251103_101145.jpg',
        './images/6/6c/20251106_083122.jpg',
        './images/6/6c/20251106_083126.jpg',
        './images/6/6c/20251106_083136.jpg',
        './images/6/6c/20251106_083735.jpg',
        './images/6/6c/20251106_083738.jpg',
        './images/6/6c/20251106_083752.jpg',
        './images/6/6c/20251106_083817.jpg',
        './images/6/6c/20251106_084252.jpg',
        './images/6/6c/20251106_084256.jpg'
    ],
};

document.addEventListener('DOMContentLoaded', () => {
    // ========== SPLASH SCREEN / PRELOADER ==========
    const splashScreen = document.getElementById('splash-screen');
    const body = document.body;
    
    // Initialize body as loading state
    body.classList.add('loading');
    
    // Function to handle splash screen removal
    function removeSplashScreen() {
        if (splashScreen) {
            splashScreen.classList.add('fade-out');

            setTimeout(() => {
                splashScreen.style.display = 'none';
            }, 1000);
        }
        // SIEMPRE sacar el loading, haya o no splash
        body.classList.remove('loading');
    }


    // Remove splash screen after 2 seconds (reducido para carga más rápida)
    setTimeout(removeSplashScreen, 2000);
    
    if (splashScreen) {
        splashScreen.addEventListener('click', removeSplashScreen);
    }

    // ========== DETECTAR SI ESTAMOS EN UNA PÁGINA DE GALERÍA ==========
    const galleryContainer = document.getElementById('galleryContainer');
    if (galleryContainer) {
        // Detectar qué galería es basándose en el título de la página
        const pageTitle = document.title;
        let gradeKey = '';
        
        if (pageTitle.includes('1°A') || pageTitle.includes('1st A')) gradeKey = '1a';
        else if (pageTitle.includes('1°B') || pageTitle.includes('1st B')) gradeKey = '1b';
        else if (pageTitle.includes('1°C') || pageTitle.includes('1st C')) gradeKey = '1c';
        else if (pageTitle.includes('3°A') || pageTitle.includes('3rd A')) gradeKey = '3a';
        else if (pageTitle.includes('3°B') || pageTitle.includes('3rd B')) gradeKey = '3b';
        else if (pageTitle.includes('3°C') || pageTitle.includes('3rd C')) gradeKey = '3c';
        else if (pageTitle.includes('6°A') || pageTitle.includes('6th A')) gradeKey = '6a';
        else if (pageTitle.includes('6°B') || pageTitle.includes('6th B')) gradeKey = '6b';
        else if (pageTitle.includes('6°C') || pageTitle.includes('6th C')) gradeKey = '6c';

        // Cargar imágenes para esta galería con lazy loading
        if (gradeKey && galleryImages[gradeKey]) {
            const images = galleryImages[gradeKey];
            images.forEach(src => {
                const feedItem = document.createElement('div');
                feedItem.className = 'feed-item';
                feedItem.setAttribute('data-type', 'image');
                feedItem.setAttribute('data-src', src);
                
                const img = document.createElement('img');
                img.loading = 'lazy'; // Lazy loading nativo
                img.src = src;
                img.alt = `${gradeKey} image`;
                
                feedItem.appendChild(img);
                galleryContainer.appendChild(feedItem);
            });

            // Inicializar eventos de clic para las imágenes después de cargarlas
            initializeFeedItemClicks();
        }
    }

    // ========== DATOS DEL ELENCO ==========
    const castData = {
        shrek: { nameEn: 'Shrek', nameEs: 'Shrek', actor: 'Tiziano De Jesús', grade: '6°C' },
        shrek_voice: { nameEn: 'Shrek Voice', nameEs: 'Voz de Shrek', actor: 'Gael Cespedes', grade: '6°C' },
        donkey: { nameEn: 'Donkey', nameEs: 'Burro', actor: 'Valentín Leiva', grade: '6°C' },
        red_riding_hood: { nameEn: 'Red Riding Hood', nameEs: 'Caperucita Roja', actor: 'Guadalupe Lacquaniti', grade: '6°A' },
        grandmother: { nameEn: 'Grandmother', nameEs: 'Abuela', actor: 'Carmela Carrizo', grade: '6°A' },
        woodcutter: { nameEn: 'Woodcutter', nameEs: 'Leñador', actor: 'Gerónimo Miño', grade: '6°B' },
        big_bad_wolf: { nameEn: 'Big Bad Wolf', nameEs: 'Lobo Feroz', actor: 'Gianluca Gómez', grade: '6°B' },
        belle: { nameEn: 'Belle', nameEs: 'Bella', actor: 'Catalina Antonovic', grade: '6°C' },
        beast: { nameEn: 'Beast', nameEs: 'Bestia', actor: 'Luciano Orellana', grade: '6°C' },
        puss: { nameEn: 'Puss in Boots', nameEs: 'Gato con Botas', actor: 'Enzo Calderon', grade: '3°C' },
        jasmine: { nameEn: 'Jasmine', nameEs: 'Jazmín', actor: 'Milagros Ledesma', grade: '4°C' },
        aladdin: { nameEn: 'Aladdin', nameEs: 'Aladdín', actor: 'Noah Figueroa', grade: '4°B' },
        genie: { nameEn: 'Genie', nameEs: 'Genio', actor: 'Joaquín Barocco', grade: '4°A' },
        genie_voice: { nameEn: 'Genie Voice', nameEs: 'Voz del Genio', actor: 'Dante Tankía Salinas', grade: '4°A' },
        mowgli: { nameEn: 'Mowgli', nameEs: 'Mowli', actor: 'Bautista Soria', grade: '5°B' },
        bagheera: { nameEn: 'Bagheera', nameEs: 'Bagheera', actor: 'Allegra Garay', grade: '5°A' },
        baloo: { nameEn: 'Baloo', nameEs: 'Baloo', actor: 'Vicente Montiel', grade: '5°C' },
        hercules: { nameEn: 'Hercules', nameEs: 'Hércules', actor: 'Santos Gigena', grade: '6°C' },
        magic_mirror: { nameEn: 'Magic Mirror', nameEs: 'Espejo Mágico', actor: 'Máximo Burgueño', grade: '6°A' }
        };
    
    // ========== CAMBIO DE IDIOMA ==========
    let currentLanguage = localStorage.getItem('language') || 'es'; // Idioma por defecto: español
    const languageToggle = document.getElementById('languageToggle');
    const langText = document.querySelector('.lang-text');

    // Aplicar idioma guardado al cargar
    applyLanguage(currentLanguage);

    // Event listener para el botón de idioma
    if (languageToggle) {
        languageToggle.addEventListener('click', () => {
            currentLanguage = currentLanguage === 'es' ? 'en' : 'es';
            localStorage.setItem('language', currentLanguage);
            applyLanguage(currentLanguage);
        });
    }

    function applyLanguage(lang) {
        // Actualizar texto del botón
        if (langText) {
            langText.textContent = lang === 'es' ? 'ES' : 'EN';
        }

        // Actualizar todos los elementos con data-lang
        document.querySelectorAll('[data-lang-en][data-lang-es]').forEach(element => {
            if (lang === 'en') {
                element.textContent = element.getAttribute('data-lang-en');
            } else {
                element.textContent = element.getAttribute('data-lang-es');
            }
        });

        // Actualizar el título de la página
        if (lang === 'en') {
            document.title = document.title.replace('Festival del Pantano Encantado 2025', 'The Enchanted Swamp Festival 2025')
                                          .replace('Galería del Festival', 'Festival Gallery');
        } else {
            document.title = document.title.replace('The Enchanted Swamp Festival 2025', 'Festival del Pantano Encantado 2025')
                                          .replace('Festival Gallery', 'Galería del Festival');
        }
    }

    // --- Función para agendar el evento ---
    const addToCalendarBtn = document.getElementById('addToCalendarBtn');
    if (addToCalendarBtn) {
        addToCalendarBtn.addEventListener('click', () => {
            const lang = currentLanguage;
            const eventTitle = lang === 'en' 
                ? "The Enchanted Swamp Festival 2025 - Cristo Rey Institute"
                : "Festival del Pantano Encantado 2025 - Instituto Cristo Rey";
            const eventLocation = "Instituto Parroquial Cristo Rey, Monseñor López May 3304, B1757 Gregorio de Laferrere, Provincia de Buenos Aires";
            const eventDescription = lang === 'en'
                ? "Don't miss the annual art festival! Explore the talent of our students."
                : "No te pierdas el festival anual de arte. ¡Explora el talento de nuestros estudiantes!";

            // **IMPORTANTE: Actualiza esta fecha y hora real del evento**
            // Formato: YYYY-MM-DDTHH:MM:SS
            const eventStartDate = "2025-11-15T18:00:00"; // Ejemplo: 15 de Noviembre de 2025, 18:00
            const eventEndDate = "2025-11-15T20:00:00";   // Ejemplo: 15 de Noviembre de 2025, 20:00

            const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&dates=${encodeURIComponent(eventStartDate.replace(/[-:]|\.\d{3}/g, ''))}/${encodeURIComponent(eventEndDate.replace(/[-:]|\.\d{3}/g, ''))}&details=${encodeURIComponent(eventDescription)}&location=${encodeURIComponent(eventLocation)}&sf=true&output=xml`;

            // Abre una nueva ventana para añadir a Google Calendar
            window.open(calendarUrl, '_blank');

            // También puedes generar un archivo .ics para Outlook/Apple Calendar
            // const icsContent = `BEGIN:VCALENDAR
            // VERSION:2.0
            // PRODID:-//hacksw/handcal//NONSGML v1.0//EN
            // BEGIN:VEVENT
            // UID:${new Date().getTime()}@example.com
            // DTSTAMP:${new Date().toISOString().replace(/[-:]|\.\d{3}/g, '')}Z
            // DTSTART:${eventStartDate.replace(/[-:]|\.\d{3}/g, '')}
            // DTEND:${eventEndDate.replace(/[-:]|\.\d{3}/g, '')}
            // SUMMARY:${eventTitle}
            // DESCRIPTION:${eventDescription}
            // LOCATION:${eventLocation}
            // END:VEVENT
            // END:VCALENDAR`;

            // const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            // const url = URL.createObjectURL(blob);
            // const a = document.createElement('a');
            // a.href = url;
            // a.download = 'MuestraDeArteCristoRey.ics';
            // document.body.appendChild(a);
            // a.click();
            // document.body.removeChild(a);
            // URL.revokeObjectURL(url);
        });
    }

    // --- Lógica para el Modal Fullscreen (compartido por index.html y feed.html) ---
    const fullscreenModal = document.getElementById('fullscreenModal');
    const closeButton = document.querySelector('.modal .close-button');
    const modalImage = document.getElementById('modalImage');
    const modalVideo = document.getElementById('modalVideo');
    const prevButton = document.querySelector('.prev-button');
    const nextButton = document.querySelector('.next-button');

    let currentItems = [];
    let currentIndex = 0;

    function openModal(itemElement) {
        if (!fullscreenModal || !modalImage || !modalVideo || !itemElement) return;

        fullscreenModal.style.display = 'flex';

        const type = itemElement.dataset.type || (itemElement.tagName === 'IMG' ? 'image' : 'video');
        const src = itemElement.dataset.full || itemElement.dataset.src || itemElement.src;
        const alt = itemElement.alt || '';

        if (type === 'image') {
            modalImage.src = src;
            modalImage.alt = alt;
            modalImage.style.display = 'block';
            modalVideo.style.display = 'none';
            modalVideo.pause();
        } else if (type === 'video') {
            modalVideo.src = src;
            modalVideo.style.display = 'block';
            modalImage.style.display = 'none';
            modalVideo.play();
        }

        if (document.body.classList.contains('feed-page')) {
            currentItems = Array.from(document.querySelectorAll('.feed-item'));
        } else {
            const visibleGallery =
                document.querySelector('.grade-gallery-section[style*="block"] .gallery') ||
                document.querySelector('.project-gallery');

            if (visibleGallery) {
                currentItems = Array.from(visibleGallery.querySelectorAll('.gallery__item'));
            } else {
                currentItems = Array.from(document.querySelectorAll('.project-gallery .gallery__item'));
            }
        }

        currentIndex = currentItems.indexOf(itemElement.closest('.feed-item, .gallery__item')) || 0;
        updateNavigationButtons();
    }

    function closeModal() {
        if (!fullscreenModal) return;
        fullscreenModal.style.display = 'none';
        if (modalVideo) {
            modalVideo.pause();
            modalVideo.currentTime = 0;
            modalVideo.src = '';
        }
        if (modalImage) modalImage.src = '';
    }

    function showNext() {
        if (!currentItems.length) return;
        currentIndex = (currentIndex + 1) % currentItems.length;
        const el = currentItems[currentIndex].querySelector('img, video') || currentItems[currentIndex];
        openModal(el);
    }

    function showPrev() {
        if (!currentItems.length) return;
        currentIndex = (currentIndex - 1 + currentItems.length) % currentItems.length;
        const el = currentItems[currentIndex].querySelector('img, video') || currentItems[currentIndex];
        openModal(el);
    }

    function updateNavigationButtons() {
        if (!prevButton || !nextButton) return;
        if (currentItems.length > 1) {
            prevButton.style.display = 'block';
            nextButton.style.display = 'block';
        } else {
            prevButton.style.display = 'none';
            nextButton.style.display = 'none';
        }
    }

    // Función para inicializar eventos de clic en feed items
    function initializeFeedItemClicks() {
        document.querySelectorAll('.feed-item').forEach(item => {
            item.addEventListener('click', () => {
                const mediaElement = item.querySelector('img, video');
                if (!mediaElement) return;

                mediaElement.dataset.type = item.dataset.type || (mediaElement.tagName === 'IMG' ? 'image' : 'video');
                mediaElement.dataset.full = item.dataset.src || mediaElement.src;
                mediaElement.dataset.src = item.dataset.src || mediaElement.src;

                openModal(mediaElement);
            });
        });
    }

    // Click en items de galería (index.html)
    document.querySelectorAll('.gallery__item').forEach(item => {
        item.addEventListener('click', () => {
            const media = item.querySelector('img, video') || item;
            openModal(media);
        });
    });

    // Listeners del modal solo si existen todos los elementos clave
    if (fullscreenModal && closeButton && prevButton && nextButton) {
        closeButton.addEventListener('click', closeModal);
        prevButton.addEventListener('click', showPrev);
        nextButton.addEventListener('click', showNext);

        fullscreenModal.addEventListener('click', (e) => {
            if (e.target === fullscreenModal) closeModal();
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && fullscreenModal.style.display === 'flex') {
                closeModal();
            }
        });
    }








    // ========== LÓGICA PARA MODAL DEL ELENCO (OBSOLETO, REEMPLAZADO POR MODAL DE ALUMNOS) ==========
    // La funcionalidad del modal del elenco ha sido integrada en el modal de alumnos.
    // Las tarjetas de personajes ahora abren el modal de alumnos directamente.
    // El código anterior para 'castModal' se puede eliminar o dejar comentado por referencia.
    /*
    const castModal = document.getElementById('castModal');
    const castCharacterName = document.getElementById('castCharacterName');
    // ... (resto del código obsoleto)
    */

    // ========== LÓGICA PARA MODAL DE ALUMNOS ==========
    const studentModal = document.getElementById('studentModal');
    const studentPhoto = document.getElementById('studentPhoto');
    const studentName = document.getElementById('studentName');
    const studentGrade = document.getElementById('studentGrade');

    if (studentModal && studentPhoto && studentName && studentGrade) {
        function openStudentModal(name, grade) {
            const photoFileName = name.toLowerCase().replace(/\s+/g, '_') + '.svg';

            studentName.textContent = name;
            studentGrade.textContent = grade;
            studentPhoto.src = `./images/alumnos/${photoFileName}`;

            studentPhoto.onerror = () => {
                const initials = name.split(' ').map(n => n[0]).join('');
                studentPhoto.src = `https://ui-avatars.com/api/?name=${initials}&background=random&color=fff`;
                studentPhoto.onerror = null;
            };

            studentModal.style.display = 'flex';
        }

        function closeStudentModal() {
            studentModal.style.display = 'none';
        }

        // Nombres clickeables
        document.querySelectorAll('.student-name').forEach(nameSpan => {
            nameSpan.addEventListener('click', () => {
                const name = nameSpan.dataset.name;
                const grade = nameSpan.dataset.grade;
                openStudentModal(name, grade);
            });
        });

        // Tarjetas de personajes - SIN acción de modal (removido)

        // Botón cerrar dentro del modal
        const studentCloseBtn = studentModal.querySelector('.close-button');
        if (studentCloseBtn) {
            studentCloseBtn.addEventListener('click', closeStudentModal);
        }

        // Cerrar haciendo click fuera
        studentModal.addEventListener('click', (e) => {
            if (e.target === studentModal) {
                closeStudentModal();
            }
        });

        // ESC para cerrar SOLO si el modal existe y está visible
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && studentModal.style.display === 'flex') {
                closeStudentModal();
            }
        });
    }
});